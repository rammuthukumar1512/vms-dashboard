<mat-dialog-content class="dialog-scroll">
      <div class="severity-header">
        <div class="d-flex justify-content-between align-items-center px-1 pt-2 gap-5">
          <h2 class="m-0 p-2">Vulnerabilities for <span class="text-ellipsis vuln-software" matTooltip="{{data.cpeName}}">"{{ data.cpeName }}"</span></h2>
          
    <mat-dialog-actions class="justify-content-end">
      <button mat-button (click)="dialogRef.close()">Close</button>
    </mat-dialog-actions>
        </div>
      </div>

      <ng-container *ngIf="data.vulnerabilities.length; else noVulnerabilities">
        <div class="table-wrapper">
          <table mat-table [dataSource]="data.vulnerabilities" class="comp-table">
            <ng-container matColumnDef="cveId">
              <th mat-header-cell *matHeaderCellDef>CVE ID</th>
              <td mat-cell *matCellDef="let vuln">{{ vuln.cveId }}</td>
            </ng-container>

            <ng-container matColumnDef="description">
              <th mat-header-cell *matHeaderCellDef>Description</th>
              <td mat-cell *matCellDef="let vuln">{{ vuln.cveDescription }}</td>
            </ng-container>

            <ng-container matColumnDef="severity">
              <th class="text-center" mat-header-cell *matHeaderCellDef>Severity</th>
              <td class="text-center" mat-cell *matCellDef="let vuln">
                <span [ngClass]="{
                  'severity-critical': vuln.cvssMetrics[0]?.baseSeverity.toLowerCase() === 'critical',
                  'severity-high': vuln.cvssMetrics[0]?.baseSeverity.toLowerCase() === 'high',
                  'severity-medium': vuln.cvssMetrics[0]?.baseSeverity.toLowerCase() === 'medium',
                  'severity-low': vuln.cvssMetrics[0]?.baseSeverity.toLowerCase() === 'low'
                }">{{ vuln.cvssMetrics[0]?.baseSeverity || 'N/A' }}</span>
              </td>
            </ng-container>

            <!-- <ng-container matColumnDef="cvssScore">
              <th class="text-center" mat-header-cell *matHeaderCellDef>CVSS Score</th>
              <td class="text-center" mat-cell *matCellDef="let vuln">{{ vuln.cvssMetrics[0]?.baseScore || 0 }}</td>
            </ng-container> -->
            <ng-container matColumnDef="cvssScore">
  <th class="text-center" mat-header-cell *matHeaderCellDef (click)="toggleSort()" style="cursor: pointer;">
    CVSS Score
    <span class="cvss-sort-icon">
      <i *ngIf="sortState === 0" class="bi bi-filter text-secondary-emphasis"></i>
      <i *ngIf="sortState === 1" class="bi bi-sort-numeric-up-alt text-secondary-emphasis"></i>
      <i *ngIf="sortState === 2" class="bi bi-sort-numeric-down-alt text-secondary-emphasis"></i>
    </span>
  </th>
  <td class="text-center" mat-cell *matCellDef="let vuln">
    {{ vuln.cvssMetrics[0]?.baseScore || 0 }}
  </td>
</ng-container>


            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>
      </ng-container>

      <ng-template #noVulnerabilities>
        <p>No vulnerabilities found</p>
      </ng-template>
    </mat-dialog-content>
   <footer class="p-3"></footer>
  