<mat-dialog-content class="dialog-scroll">
  <div class="severity-header">
    <div class="d-flex justify-content-between align-items-center px-1 pt-2 gap-5 vuln-header" >
      <h2 class="m-0 p-2">
        Vulnerabilities for
        <span class="vuln-software text-ellipsis-software-name" matTooltipPosition="right" matTooltip="{{data.softwareName}}">"{{ data.softwareName }}"  <ng-container *ngIf="totalVulnerabilitiesCount() !== 0">
    ({{ totalVulnerabilitiesCount() }})
  </ng-container></span>
      </h2>
      <div class="mb-1 p-2 text-ellipsis" *ngIf="isResolved && data.cpeName" matTooltip="{{data.cpeName}}" matTooltipPosition="left">
        <strong>CPE Name:</strong> {{ data.cpeName }}
      </div>
      <div class="mt-2" *ngIf="!isResolved">
        <!-- <button mat-raised-button color="primary" (click)="openLikelyCpeModal()" class="resolve-btn">Resolve Application</button> -->
      <p>
      This application remains unresolved.Click
      <a class="clickable-here" (click)="navigateToResolveApplications()">here</a>
      to resolve it
    </p>
      </div>
    </div>
    <div class="severity-buttons">
      <button mat-raised-button class="severity-btn critical" [ngClass]="{'active-border': selectedSeverity === 'Critical'}"
 (click)="filterVulnerabilities('Critical')">
        Critical: {{ data.severityCounts.critical }}
      </button>
      <button mat-raised-button class="severity-btn high" [ngClass]="{'active-border': selectedSeverity === 'High'}"
 (click)="filterVulnerabilities('High')">
        High: {{ data.severityCounts.high }}
      </button>
      <button mat-raised-button class="severity-btn medium" [ngClass]="{'active-border': selectedSeverity === 'Medium'}"
 (click)="filterVulnerabilities('Medium')">
        Medium: {{ data.severityCounts.medium }}
      </button>
      <button mat-raised-button class="severity-btn low" [ngClass]="{'active-border': selectedSeverity === 'Low'}"
 (click)="filterVulnerabilities('Low')">
        Low: {{ data.severityCounts.low }}
      </button>
      <button mat-raised-button class="severity-btn all" [ngClass]="{'active-border': selectedSeverity === null}"
 (click)="filterVulnerabilities(null)">
        All
      </button>
    </div>
  </div>
    <ng-container *ngIf="isResolved; else unresolvedApp;">
  <ng-container *ngIf="filteredVulnerabilities.length; else noVulnerabilities;">
    <table #vulnerabilityTable mat-table [dataSource]="displayedVulnerabilities" class="comp-table">
      <!-- <ng-container matColumnDef="cveId">
        <th mat-header-cell *matHeaderCellDef>CVE ID</th>
        <td mat-cell *matCellDef="let vuln;let i = index"> <span (click)="showVulnerabilityMetrics(vuln.cveId, i)" class="cursor-pointer cve-id">{{ vuln.cveId }}</span></td>
      </ng-container> -->
          <ng-container matColumnDef="cveId">
          <th  class="fw-bolder cve-id-column " mat-header-cell *matHeaderCellDef> CVE ID
   <span class="cvss-sort-icon" matTooltip="sort by CVE-ID" (click)="toggleCveIdSort()">
    <i *ngIf="cveIdSortState === 0" class="bi bi-filter text-secondary-emphasis"></i>
    <i *ngIf="cveIdSortState === 1" class="bi bi-sort-numeric-up-alt text-secondary-emphasis"></i>
    <i *ngIf="cveIdSortState === 2" class="bi bi-sort-numeric-down-alt text-secondary-emphasis"></i>
  </span></th>
          <td class="cursor-pointer cve-id-column" mat-cell *matCellDef="let cve;let i = index" (click)="showVulnerabilityMetrics(cve.cveId, i)"> <span class="cve-id">{{ cve.cveId }}</span>  </td>
        </ng-container>

      <!-- <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef>Description</th>
        <td mat-cell *matCellDef="let vuln">{{ vuln.description }}</td>
      </ng-container> -->
      <ng-container matColumnDef="description">
  <th mat-header-cell *matHeaderCellDef class="description-column text-center">Description</th>
  <td mat-cell *matCellDef="let vuln" class="description-column">{{ vuln.description }}</td>
</ng-container>

      <ng-container matColumnDef="severity">
        <th class="text-center" mat-header-cell *matHeaderCellDef>Severity</th>
        <td class="text-center" mat-cell *matCellDef="let vuln">
          <span [ngClass]="{
            'severity-critical': vuln.severity.toLowerCase() === 'critical',
            'severity-high': vuln.severity.toLowerCase() === 'high',
            'severity-medium': vuln.severity.toLowerCase() === 'medium',
            'severity-low': vuln.severity.toLowerCase() === 'low'
          }">{{ vuln.severity }}</span>
        </td>
      </ng-container>
      <!-- <ng-container matColumnDef="cvssScore">
        <th class="text-center" mat-header-cell *matHeaderCellDef>CVSS Score</th>
        <td class="text-center" mat-cell *matCellDef="let vuln;">{{ vuln.cvssScore }}</td>
      </ng-container> -->
      <ng-container matColumnDef="cvssScore">
  <th class="text-center" mat-header-cell *matHeaderCellDef>
    CVSS Score
    <span class="cvss-sort-icon" matTooltip="Sort by CVSS Score" (click)="toggleCvssSort()">
      <i *ngIf="cvssSortState === 0" class="bi bi-filter text-secondary-emphasis"></i>
      <i *ngIf="cvssSortState === 1" class="bi bi-sort-numeric-up-alt text-secondary-emphasis"></i>
      <i *ngIf="cvssSortState === 2" class="bi bi-sort-numeric-down-alt text-secondary-emphasis"></i>
    </span>
  </th>
  <td class="text-center" mat-cell *matCellDef="let vuln;">{{ vuln.cvssScore }}</td>
</ng-container>

      <tr mat-header-row *matHeaderRowDef="vulnDisplayedColumns"></tr>
      <!-- <tr mat-row *matRowDef="let row;let i = index; columns: vulnDisplayedColumns;" #vulnerabilityTableRow></tr> -->
       <tr
  mat-row
  *matRowDef="let row; let i = index; columns: vulnDisplayedColumns;"
  #vulnerabilityTableRow
  [ngClass]="{ 'selected-row': selectedRowIndex === i }">
</tr>

    </table>
  </ng-container>
  </ng-container>
  <ng-template #noVulnerabilities>
    <p class="mt-3">No vulnerabilities found</p>
  </ng-template>
  <ng-template #unresolvedApp>
    <p class="mt-3">No Data Found</p>
  </ng-template>
</mat-dialog-content>
<mat-dialog-actions class="justify-content-end">
  <button mat-button (click)="onClose()">Close</button>
</mat-dialog-actions>