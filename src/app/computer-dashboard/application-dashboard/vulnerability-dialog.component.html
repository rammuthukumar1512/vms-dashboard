<mat-dialog-content class="dialog-scroll">
  <div class="severity-header">
    <div class="d-flex justify-content-between align-items-center px-1 pt-2 gap-5 vuln-header" >
      <h2 class="m-0 p-2">
        Vulnerabilities for
        <span class="vuln-software text-ellipsis-software-name" matTooltip="{{data.softwareName}}">"{{ data.softwareName }}"</span>
      </h2>
      <div class="mb-1 p-2 text-ellipsis" *ngIf="isResolved && data.cpeName" matTooltip="{{data.cpeName}}">
        <strong>CPE Name:</strong> {{ data.cpeName }}
      </div>
      <div class="mt-2" *ngIf="!isResolved">
        <!-- <button mat-raised-button color="primary" (click)="openLikelyCpeModal()" class="resolve-btn">Resolve Application</button> -->
      <p>
      This application remains unresolved.Click
      <a class="clickable-here" (click)="navigateToResolveApplications()">here</a>
      to resolve it
    </p>
      </div>
    </div>
    <div class="severity-buttons">
      <button mat-raised-button class="severity-btn critical" [ngClass]="{'active-border': selectedSeverity === 'Critical'}"
 (click)="filterVulnerabilities('Critical')">
        Critical: {{ data.severityCounts.critical }}
      </button>
      <button mat-raised-button class="severity-btn high" [ngClass]="{'active-border': selectedSeverity === 'High'}"
 (click)="filterVulnerabilities('High')">
        High: {{ data.severityCounts.high }}
      </button>
      <button mat-raised-button class="severity-btn medium" [ngClass]="{'active-border': selectedSeverity === 'Medium'}"
 (click)="filterVulnerabilities('Medium')">
        Medium: {{ data.severityCounts.medium }}
      </button>
      <button mat-raised-button class="severity-btn low" [ngClass]="{'active-border': selectedSeverity === 'Low'}"
 (click)="filterVulnerabilities('Low')">
        Low: {{ data.severityCounts.low }}
      </button>
      <button mat-raised-button class="severity-btn all" [ngClass]="{'active-border': selectedSeverity === null}"
 (click)="filterVulnerabilities(null)">
        All
      </button>
    </div>
  </div>
  <ng-container *ngIf="filteredVulnerabilities.length; else noVulnerabilities;">
    <table mat-table [dataSource]="filteredVulnerabilities" class="comp-table">
      <ng-container matColumnDef="cveId">
        <th mat-header-cell *matHeaderCellDef>CVE ID</th>
        <td mat-cell *matCellDef="let vuln;let i = index"> <span (click)="showVulnerabilityMetrics(vuln.cveId, i)" class="cursor-pointer cve-id">{{ vuln.cveId }}</span></td>
      </ng-container>
      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef>Description</th>
        <td mat-cell *matCellDef="let vuln">{{ vuln.description }}</td>
      </ng-container>
      <ng-container matColumnDef="severity">
        <th class="text-center" mat-header-cell *matHeaderCellDef>Severity</th>
        <td class="text-center" mat-cell *matCellDef="let vuln">
          <span [ngClass]="{
            'severity-critical': vuln.severity.toLowerCase() === 'critical',
            'severity-high': vuln.severity.toLowerCase() === 'high',
            'severity-medium': vuln.severity.toLowerCase() === 'medium',
            'severity-low': vuln.severity.toLowerCase() === 'low'
          }">{{ vuln.severity }}</span>
        </td>
      </ng-container>
      <ng-container matColumnDef="cvssScore">
        <th class="text-center" mat-header-cell *matHeaderCellDef>CVSS Score</th>
        <td class="text-center" mat-cell *matCellDef="let vuln;">{{ vuln.cvssScore }}</td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="vulnDisplayedColumns"></tr>
      <!-- <tr mat-row *matRowDef="let row;let i = index; columns: vulnDisplayedColumns;" #vulnerabilityTableRow></tr> -->
       <tr
  mat-row
  *matRowDef="let row; let i = index; columns: vulnDisplayedColumns;"
  #vulnerabilityTableRow
  [ngClass]="{ 'selected-row': selectedRowIndex === i }">
</tr>

    </table>
  </ng-container>
  <ng-template #noVulnerabilities>
    <p>No vulnerabilities found</p>
  </ng-template>
</mat-dialog-content>
<mat-dialog-actions class="justify-content-end">
  <button mat-button (click)="onClose()">Close</button>
</mat-dialog-actions>